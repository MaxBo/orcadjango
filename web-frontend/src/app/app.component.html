<mat-toolbar class="main-nav">
  <a class="navbar-brand" href="/">OrcaDjango</a>
  <span class="page-links" fxShow="true" fxHide.lt-md="true">
    <a *ngIf="auth.user$ | async"
       class="link"
       title="projects"
       routerLink="/projects"
       routerLinkActive="active-link"
       [routerLinkActiveOptions]="{exact: false}">
      Projects
    </a>
    <a *ngIf="settings.activeProject$ | async"
       class="link"
       title="scenarios"
       routerLink="/scenarios"
       routerLinkActive="active-link"
       [routerLinkActiveOptions]="{exact: false}">
      Scenarios
    </a>
    <a *ngIf="settings.activeScenario$ | async"
       class="link"
       title="injectables"
       routerLink="/injectables"
       routerLinkActive="active-link"
       [routerLinkActiveOptions]="{exact: false}">
      Injectables
    </a>
    <a *ngIf="settings.activeScenario$ | async"
       class="link"
       title="steps and run"
       routerLink="/steps"
       routerLinkActive="active-link"
       [routerLinkActiveOptions]="{exact: false}">
      Steps & Run
    </a>
    <button mat-button [matMenuTriggerFor]="userMenu">
      <mat-icon>person_outline</mat-icon>
      {{(auth.user$ | async)?.username || 'not logged in'}}
    </button>
    <mat-menu #userMenu>
      <a *ngIf="(auth.user$ | async) else login"
         mat-menu-item
         (click)="auth.logout()" href="">
        Logout
      </a>
      <ng-template #login>
        <a mat-menu-item routerLink="/login">Login</a>
      </ng-template>
    </mat-menu>
  </span>
</mat-toolbar>
<mat-sidenav-container class="main-container">
  <mat-sidenav class="sidenav" mode="side" opened
               *ngIf="auth.user$ | async">
    <mat-form-field id="module-select">
      <mat-label>Module</mat-label>
      <mat-select (selectionChange)="settings.setModule($event.value)" [value]="settings.module$.value">
        <mat-option value="">none</mat-option>
        <mat-option *ngFor="let module of settings.modules" [value]="module.path">
          {{module.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-card id="active-project"
              routerLink="/projects"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{exact: false}">
      <ng-container *ngIf="settings.activeProject$ | async; else noProject">
        <mat-card-header>
          <mat-card-title>Project</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{settings.activeProject$.value?.name}}</p>
          <p *ngIf="settings.activeProject$.value?.code">{{settings.activeProject$.value?.code}}</p>
          <p>{{settings.activeProject$.value?.description}}</p>
        </mat-card-content>
      </ng-container>
      <ng-template #noProject>
        <mat-card-content>no project selected</mat-card-content>
      </ng-template>
    </mat-card>
    <mat-card *ngIf="settings.activeProject$ | async" id="active-scenario"
              routerLink="/scenarios"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{exact: false}">
      <ng-container *ngIf="settings.activeScenario$ | async; else noScenario">
        <mat-card-header>
          <mat-card-title>Scenario</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{settings.activeScenario$.value?.name}}</p>
        </mat-card-content>
      </ng-container>
      <ng-template #noScenario>
        <mat-card-content>no scenario selected</mat-card-content>
      </ng-template>
    </mat-card>
  </mat-sidenav>
  <mat-sidenav-content class="app-container">
    <router-outlet></router-outlet>
  </mat-sidenav-content>
</mat-sidenav-container>
